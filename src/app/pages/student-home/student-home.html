<section class="home-wrap">
  <header class="top-bar">
    <button class="menu-toggle" (click)="toggleSidebar()">
      <img src="/icon/Hamburger_MD.png" alt="" />
    </button>

    <div class="search-bar" [formGroup]="filtros">
      <div class="search">
        <span class="ico">üîç</span>
        <input
          type="text"
          placeholder="Busca un asesor"
          formControlName="search"
        />
        <button
          class="clear"
          *ngIf="filtros.controls['search'].value"
          (click)="filtros.controls['search'].setValue('')"
        >
          ‚úï
        </button>
      </div>

      <div class="filters">
        <div class="select">
          <select formControlName="lugar">
            <option value="">Lugar</option>
            <option
              *ngFor="let l of lugares; trackBy: trackByStr"
              [value]="l"
            >
              {{ l }}
            </option>
          </select>
        </div>
        <div class="select">
          <select formControlName="nivel">
            <option value="">Nivel</option>
            <option
              *ngFor="let n of niveles; trackBy: trackByStr"
              [value]="n"
            >
              {{ n }}
            </option>
          </select>
        </div>
        <div class="select">
          <select formControlName="materia">
            <option value="">Materias</option>
            <option
              *ngFor="let m of materias"
              [value]="m.id"
            >
              {{ m.name }}
            </option>
          </select>
        </div>
        <button class="refresh" (click)="clearFilters()" title="Limpiar filtros">
          ‚Üª
        </button>
      </div>
    </div>

    <div class="right-actions">
      <img src="/icon/Bell.png" alt="Notificaciones" />

      <a
        class="avatar"
        [class.has-img]="topAvatarUrl"
        [routerLink]="['/complete-profile']"
        title="Completar mi perfil"
        [attr.aria-busy]="isLoadingProfile"
      >
        <img *ngIf="topAvatarUrl" [src]="topAvatarUrl" alt="Mi avatar" />
        <span *ngIf="!topAvatarUrl" aria-hidden="true">üë§</span>
      </a>
    </div>
  </header>

  <aside class="sidebar" [class.sidebar-open]="isSidebarOpen">
    <div class="sidebar-overlay" (click)="closeSidebar()"></div>
    <div class="sidebar-header">
      <img class="agora-icon" src="/agora_icon.png" alt="" />
      <button class="close-menu-btn" (click)="closeSidebar()">
        <span class="material-icons"><</span>
      </button>
    </div>
    <nav class="sidebar-menu">
      <a href="#" (click)="closeSidebar()" class="menu-item active">
        <img src="/icon/home.png" alt="" />
        Inicio
      </a>
      <a href="#" (click)="closeSidebar()" class="menu-item">
        <img src="/icon/fav.png" alt="" />
        Favoritos
      </a>
      <a href="#" (click)="closeSidebar()" class="menu-item">
        <img src="/icon/chat.png" alt="" />
        Chats
      </a>
      <a href="#" (click)="closeSidebar()" class="menu-item">
        <img src="/icon/solicitud.png" alt="" />
        Solicitudes
      </a>
    </nav>
    <div class="sidebar-footer">
      <button class="logout-btn" (click)="logout()">
        <img src="/icon/logout.png" alt="" />
        Cerrar sesi√≥n
      </button>
    </div>
  </aside>

  <main class="content">
    <h2 class="section-title">Recomendaciones</h2>

    <div class="grid">
      <article class="card" *ngFor="let t of advisers; trackBy: trackById">
        <button
          class="fav"
          [class.on]="t.bookmarked"
          (click)="toggleBookmark(t)"
          title="Guardar"
        >
          ‚òÖ
        </button>
        <div class="avatar" [class.has-img]="t.avatarUrl">
          <img *ngIf="t.avatarUrl" [src]="t.avatarUrl" alt="{{ t.name }}" />
          <span *ngIf="!t.avatarUrl" aria-hidden="true">üë§</span>
        </div>
        <div class="name">{{ t.name }}</div>
        <div class="sub"><span class="level-chip">{{ t.nivel }}</span></div>
        <div class="tags">
          <span class="tag" *ngFor="let tag of t.tags; trackBy: trackByStr">
            <span class="ico" aria-hidden="true">{{ iconFor(tag) }}</span>
            {{ tag }}
          </span>
        </div>
        <p class="desc">{{ t.description }}</p>
        <div class="actions">
          <button class="see-more">Ver m√°s</button>
        </div>
      </article>
    </div>

    <div *ngIf="advisers.length === 0" class="no-results">
      <p>No se encontraron asesores que coincidan con tus filtros.</p>
    </div>
  </main>
</section>
